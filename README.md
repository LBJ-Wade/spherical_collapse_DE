# collapse
Spherical-collapse model code

This code carries out the spherical-collapse calculation for standard cosmological models as well as for dark energy models when the dark energy can be taken to be spatially homogeneous. This calculation is valid on sub-horizon scales and takes a top-hat perturbation to exist in an otherwise featureless cosmos and follows its evolution into the non-linear regime where it reaches a maximum size and then recollapses.

The user specifies a cosmological model and the code then solves both the linear and non-linear differential equations for the overdensity of the top-hat. The calcultion stops when the overdensity of the top hat in the non-linear calcultion becomes infinite and the value of delta_c is read off from the linear. The radius of the virialised halo is taken to be half of the radius at turn around, in accordance with the virial theorem in the Einstein-de Sitter case; the virial overdensity is then calculated at the collapse time. This is different from some other authors who include the cosmological constant in the   virial condition, but it wasn't obvious to me how to extend this to dark energy models so I settled for the simple option of keeping the Einstein-de-Sitter virial radius. For Omega_m=0.3 the virial density calcuated when including $\Lambda$ is $\sim 10$ per cent higher than that provided by my code because the halo has to collapse further to counter the outward gravitational push of the cosmological constant.

The code provides the user with \texttt{dcDV.dat}; a data file containing the scale factor at the time of collapse - $a$, matter density - $\Om(a)$, $\dc$, $\Dv$, linear growth - $g(a)$, logarithmic growth rate - $f(a)\equiv\mathrm{d}\ln g/\mathrm{d}\ln a$ and the integrated growth - $G(a)$ defined in equation~(\ref{eq:integrated_growth}). These are provided for $\sim 200$ values of $a$; the user does not specify these $a$ values and instead should interpolate. The integrations are accurate to 4 significant figures for $\dc$ ($1.686$ is recovered for EdS) and 3 for $\Dv$ ($177$ is recovered for EdS) and are slightly biased in the next significant figure, there is also some numerical noise that is particularly obvious in the $\dc$ calculation, but well below the level relevant for this work.

The code compiles with gfortran, and probably with ifort too, and does not need to be linked to any libraries, so you can just '>gfortran collapse.f90' and away you go. Please let me know of any problems as soon as possible.
